<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Transaction App</title>

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 900px;
      margin: auto;
    }

    h2 {
      margin-bottom: 10px;
    }

    .summary {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
    }

    .card {
      padding: 15px;
      border-radius: 6px;
      width: 200px;
      color: #fff;
    }

    .in { background: #2ecc71; }
    .out { background: #e74c3c; }
    .balance { background: #3498db; }

    input, select, button {
      padding: 8px;
      margin: 5px 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }

    th {
      background: #f4f4f4;
    }

    .green { color: green; }
    .red { color: red; }
  </style>
</head>

<body>

  <h2>Transaction App</h2>

  <!-- SUMMARY -->
  <div class="summary">
    <div class="card in">
      <h4>Total IN</h4>
      ₹ <span id="totalIn">0</span>
    </div>
    <div class="card out">
      <h4>Total OUT</h4>
      ₹ <span id="totalOut">0</span>
    </div>
    <div class="card balance">
      <h4>Balance</h4>
      ₹ <span id="balance">0</span>
    </div>
  </div>

  <!-- FORM -->
  <h3>Add Transaction</h3>

  <input id="amount" type="number" placeholder="Amount" />
  <select id="type">
    <option value="IN">IN</option>
    <option value="OUT">OUT</option>
  </select>
  <input id="note" type="text" placeholder="Note" />
  <button onclick="addTransaction()">Add</button>

  <!-- TABLE -->
  <table>
    <thead>
      <tr>
        <th>Date</th>
        <th>Type</th>
        <th>Amount</th>
        <th>Note</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>

  <script>
    const API = "YOUR_VERCEL_API_URL/api/transactions";

    let transactions = [];

    async function loadTransactions() {
      const res = await fetch(API);
      transactions = await res.json();
      renderTable();
      calculateSummary();
    }

    async function addTransaction() {
      const amount = Number(document.getElementById("amount").value);
      const type = document.getElementById("type").value;
      const note = document.getElementById("note").value;

      if (!amount || !note) {
        alert("Enter amount and note");
        return;
      }

      await fetch(API, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount, type, note })
      });

      document.getElementById("amount").value = "";
      document.getElementById("note").value = "";

      loadTransactions();
    }

    function renderTable() {
      const body = document.getElementById("tableBody");
      body.innerHTML = "";

      transactions.forEach(t => {
        const row = document.createElement("tr");

        row.innerHTML = `
          <td>${new Date(t.created_at).toLocaleDateString()}</td>
          <td class="${t.type === 'IN' ? 'green' : 'red'}">${t.type}</td>
          <td>₹ ${t.amount}</td>
          <td>${t.note}</td>
        `;

        body.appendChild(row);
      });
    }

    function calculateSummary() {
      let totalIn = 0;
      let totalOut = 0;

      transactions.forEach(t => {
        if (t.type === "IN") totalIn += Number(t.amount);
        else totalOut += Number(t.amount);
      });

      const balance = totalIn - totalOut;

      document.getElementById("totalIn").innerText = totalIn;
      document.getElementById("totalOut").innerText = totalOut;
      document.getElementById("balance").innerText = balance;
    }

    // load on page open
    loadTransactions();
  </script>

</body>
</html>

